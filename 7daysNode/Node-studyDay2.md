---
title: Node studyDay2
date: 2020-12-19 16:08:23
tags: Node
categories: Node
description: ç®€å•çš„httpæœåŠ¡
---

<font style="color:deepskyblue;">åœ¨Nodeä¸­ä¸“é—¨æä¾›äº†ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—: http</font>

<!-- more -->  

http è¿™ä¸ªæ¨¡å—çš„èŒè´£å°±æ˜¯å¸®ä½ åˆ›å»ºç¼–å†™æœåŠ¡å™¨çš„

```nginx
//1.åŠ è½½httpæ ¸å¿ƒæ¨¡å—
var http = require('http');

// 2.ä½¿ç”¨http.createServer()æ–¹æ³•åˆ›å»ºä¸€ä¸ªwebæœåŠ¡å™¨
// è¿”å›ä¸€ä¸ªServerå®ä¾‹
var server = http.createServer();

//3.æœåŠ¡å™¨--æä¾›å¯¹æ•°æ®çš„æœåŠ¡
// å‘è¯·æ±‚
// æ¥æ”¶è¯·æ±‚
// å¤„ç†è¯·æ±‚
// ç»™ä¸ªåé¦ˆ(å‘é€å“åº”)
// æ³¨å†Œrequestè¯·æ±‚äº‹ä»¶
// å½“å®¢æˆ·ç«¯è¯·æ±‚è¿‡æ¥ï¼Œå°±ä¼šè‡ªåŠ¨è§¦å‘æœåŠ¡å™¨çš„requestè¯·æ±‚äº‹ä»¶ï¼Œç„¶åæ‰§è¡Œç¬¬äºŒä¸ªå‚æ•°:å›è°ƒå¤„ç†å‡½æ•°
server.on('request', function () {
    console.log('æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚å•¦!');
})

//4.ç»‘å®šç«¯å£å·,å¯åŠ¨æœåŠ¡å™¨
server.listen(3000, function () {
    console.log('æœåŠ¡å™¨å¯åŠ¨æˆåŠŸäº†ï¼Œå¯ä»¥é€šè¿‡http://127.0.0.1:3000/æ¥è®¿é—®');
})
```

![http_node6b80bcc5239309fa.png](https://cdn.longdoer.com/2020/12/19/http_node6b80bcc5239309fa.png)

âœï¸è¿™æ—¶å€™ä½ é€šè¿‡è¿™ä¸ªé“¾æ¥æ‰“å¼€ç½‘é¡µ,hiå‘ç°ç½‘é¡µä¸€ç›´åœ¨è½¬åœˆ,æ˜¯å› ä¸ºæˆ‘ä»¬çš„æœåŠ¡å™¨æ²¡æœ‰å¯¹æµè§ˆå™¨(å®¢æˆ·ç«¯)è¿›è¡Œå›å¤,æ‰€ä»¥æµè§ˆå™¨ä¸€ç›´åœ¨ç­‰å¾…

tips:æœ¬åœ°ç»ˆç«¯`ctr + c`å¿«æ·é”®å¯ä»¥ç»ˆæ­¢æœåŠ¡

### å‘é€å“åº”

```nginx
//1.åŠ è½½httpæ ¸å¿ƒæ¨¡å—
var http = require('http');

// 2.ä½¿ç”¨http.createServer()æ–¹æ³•åˆ›å»ºä¸€ä¸ªwebæœåŠ¡å™¨
// è¿”å›ä¸€ä¸ªServerå®ä¾‹
var server = http.createServer();

//3.æœåŠ¡å™¨--æä¾›å¯¹æ•°æ®çš„æœåŠ¡
/* request è¯·æ±‚äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œéœ€è¦æ¥æ”¶ä¸¤ä¸ªå‚æ•°:
    Requestè¯·æ±‚å¯¹è±¡
    è¯·æ±‚å¯¹è±¡å¯ä»¥ç”¨æ¥è·å–å®¢æˆ·ç«¯çš„ä¸€äº›è¯·æ±‚ä¿¡æ¯ï¼Œä¾‹å¦‚è¯·æ±‚è·¯å¾„
    Response å“åº”å¯¹è±¡
    å“åº”å¯¹è±¡å¯ä»¥ç”¨æ¥ç»™å®¢æˆ·ç«¯å‘é€å“åº”æ¶ˆæ¯ */
server.on('request', function (request, response) {
    //  æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚å•¦!è¯·æ±‚è·¯å¾„æ˜¯:/
    console.log('æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚å•¦!è¯·æ±‚è·¯å¾„æ˜¯:' + request.url);
})

//4.ç»‘å®šç«¯å£å·,å¯åŠ¨æœåŠ¡å™¨
server.listen(3000, function () {
    console.log('æœåŠ¡å™¨å¯åŠ¨æˆåŠŸäº†ï¼Œå¯ä»¥é€šè¿‡http://127.0.0.1:3000/æ¥è®¿é—®');
})
```

#### å“åº”å›å¤

```nginx
//1.åŠ è½½httpæ ¸å¿ƒæ¨¡å—
var http = require('http');

// 2.ä½¿ç”¨http.createServer()æ–¹æ³•åˆ›å»ºä¸€ä¸ªwebæœåŠ¡å™¨
// è¿”å›ä¸€ä¸ªServerå®ä¾‹
var server = http.createServer();

//3.æœåŠ¡å™¨--æä¾›å¯¹æ•°æ®çš„æœåŠ¡
/* request è¯·æ±‚äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œéœ€è¦æ¥æ”¶ä¸¤ä¸ªå‚æ•°:
    Requestè¯·æ±‚å¯¹è±¡
    è¯·æ±‚å¯¹è±¡å¯ä»¥ç”¨æ¥è·å–å®¢æˆ·ç«¯çš„ä¸€äº›è¯·æ±‚ä¿¡æ¯ï¼Œä¾‹å¦‚è¯·æ±‚è·¯å¾„
    Response å“åº”å¯¹è±¡
    å“åº”å¯¹è±¡å¯ä»¥ç”¨æ¥ç»™å®¢æˆ·ç«¯å‘é€å“åº”æ¶ˆæ¯ */
server.on('request', function (request, response) {
    //æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚å•¦!è¯·æ±‚è·¯å¾„æ˜¯:/
    console.log('æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚å•¦!è¯·æ±‚è·¯å¾„æ˜¯:' + request.url);

    //responseå¯¹è±¡æœ‰ä¸€ä¸ªæ–¹æ³•: writeå¯ä»¥ç”¨æ¥ç»™å®¢æˆ·ç«¯å‘é€å“åº”æ•°æ®
    //writeå¯ä»¥ä½¿ç”¨å¤šæ¬¡ï¼Œä½†æ˜¯æœ€åä¸€å®šè¦ä½¿ç”¨end æ¥ç»“æŸå“åº”ï¼Œå¦åˆ™å®¢æˆ·ç«¯ä¼šä¸€ç›´ç­‰å¾…
    response.write('zy!');
    response.write('node');

    //endå‘Šè¯‰å®¢æˆ·ç«¯ï¼Œæˆ‘çš„è¯è¯´å®Œäº†ï¼Œä½ å¯ä»¥å‘ˆé€’ç»™ç”¨æˆ·äº†
    response.end();
})

//4.ç»‘å®šç«¯å£å·,å¯åŠ¨æœåŠ¡å™¨
server.listen(3000, function () {
    console.log('æœåŠ¡å™¨å¯åŠ¨æˆåŠŸäº†ï¼Œå¯ä»¥é€šè¿‡http://127.0.0.1:3000/æ¥è®¿é—®');
})
```

è¿™é‡Œæ— è®ºé¡µé¢è·¯å¾„æ˜¯ä»€ä¹ˆ,é¡µé¢è¿”å›çš„ä¿¡æ¯éƒ½æ˜¯`zy!node`

ä¸¾ä¸ªğŸŒ°

```nginx
url																									response
http://127.0.0.1:3000/																zy!node
http://127.0.0.1:3000/1																zy!node
http://127.0.0.1:3000/xyz															zy!node
http://127.0.0.1:3000/xyz/12%$										     zy!node
```

### ğŸ¤”æ€è€ƒ                

#### æ ¹æ®ä¸åŒè¯·æ±‚è·¯å¾„è¿”å›ä¸åŒç»“æœ

```nginx
//1.åŠ è½½httpæ ¸å¿ƒæ¨¡å—
//1.åˆ›å»º Server
var http = require('http');
const server = http.createServer();


//2.ç›‘å¬ requestè¯·æ±‚äº‹ä»¶,è®¾ç½®è¯·æ±‚å¤„ç†å‡½æ•°
server.on('request', function (req, res) {
    console.log('æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚å•¦!è¯·æ±‚è·¯å¾„æ˜¯:' + req.url);

    /* 
    //è¿™é‡Œçš„æ–¹å¼æ¯”è¾ƒéº»çƒ¦,æ¨èæ›´ç®€å•çš„æ–¹æ³•,ç›´æ¥endçš„åŒæ—¶å‘é€å“åº”æ•°æ®
    res.write('hello');
    res.write(' node');
    res.end(); 
    */
    //ç®€å•æ–¹æ³•
    //res.end('hello Node'); 

    //æ ¹æ®ä¸åŒçš„è¯·æ±‚è·¯å¾„å‘é€ä¸åŒçš„å“åº”ç»“æœ
    //1ï¼è·å–è¯·æ±‚è·¯å¾„
    //req.urlè·å–åˆ°çš„æ˜¯ç«¯å£å·ä¹‹åçš„é‚£ä¸€éƒ¨åˆ†è·¯å¾„
    //ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„urléƒ½æ˜¯ä»¥/å¼€å¤´çš„
    //2ï¼åˆ¤æ–­è·¯å¾„å¤„ç†å“åº”
    var url = req.url;
    if (url === '/') {
        res.end("index page");
    } else if (url === '/login') {
        res.end("login page");
    } else {
        res.end("404 Not Found");
    }

});

//3.ç»‘å®šç«¯å£å·,å¯åŠ¨æœåŠ¡å™¨
server.listen(3000, function () {
    console.log('æœåŠ¡å™¨å¯åŠ¨æˆåŠŸäº†ï¼Œå¯ä»¥è®¿é—® http://127.0.0.1:3000/');
})

```

##### è¿”å›ä¸€ä¸ªæ•°ç»„æ•°æ®

```nginx
var http = require('http')

// 1. åˆ›å»º Server
var server = http.createServer()

// 2. ç›‘å¬ request è¯·æ±‚äº‹ä»¶ï¼Œè®¾ç½®è¯·æ±‚å¤„ç†å‡½æ•°
server.on('request', function (req, res) {
  console.log('æ”¶åˆ°è¯·æ±‚äº†ï¼Œè¯·æ±‚è·¯å¾„æ˜¯ï¼š' + req.url)
  console.log('è¯·æ±‚æˆ‘çš„å®¢æˆ·ç«¯çš„åœ°å€æ˜¯ï¼š', req.socket.remoteAddress, req.socket.remotePort)

  // res.write('hello')
  // res.write(' world')
  // res.end()

  // ä¸Šé¢çš„æ–¹å¼æ¯”è¾ƒéº»çƒ¦ï¼Œæ¨èä½¿ç”¨æ›´ç®€å•çš„æ–¹å¼ï¼Œç›´æ¥ end çš„åŒæ—¶å‘é€å“åº”æ•°æ®
  // res.end('hello nodejs')

  // æ ¹æ®ä¸åŒçš„è¯·æ±‚è·¯å¾„å‘é€ä¸åŒçš„å“åº”ç»“æœ
  // 1. è·å–è¯·æ±‚è·¯å¾„
  //    req.url è·å–åˆ°çš„æ˜¯ç«¯å£å·ä¹‹åçš„é‚£ä¸€éƒ¨åˆ†è·¯å¾„
  //    ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„ url éƒ½æ˜¯ä»¥ / å¼€å¤´çš„
  // 2. åˆ¤æ–­è·¯å¾„å¤„ç†å“åº”

  var url = req.url

  if (url === '/') {
    res.end('index page')
  } else if (url === '/login') {
    res.end('login page')
  } else if (url === '/products') {
    var products = [{
        name: 'è‹¹æœ X',
        price: 8888
      },
      {
        name: 'å°ç±³ Alpha',
        price: 18000
      },
      {
        name: 'oppo R7',
        price: 1999
      }
    ]

    // å“åº”å†…å®¹åªèƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®æˆ–è€…å­—ç¬¦ä¸²
    //  æ•°å­—
    //  å¯¹è±¡
    //  æ•°ç»„
    //  å¸ƒå°”å€¼
    res.end(JSON.stringify(products));//è¯•è¯•çœ‹parse
  } else {
    res.end('404 Not Found.')
  }
})

// 3. ç»‘å®šç«¯å£å·ï¼Œå¯åŠ¨æœåŠ¡
server.listen(3000, function () {
  console.log('æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œå¯ä»¥è®¿é—®äº†ã€‚ã€‚ã€‚')
})

```

